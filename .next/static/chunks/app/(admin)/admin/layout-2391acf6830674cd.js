(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[638],{4432:function(e,t,s){Promise.resolve().then(s.bind(s,3444))},3444:function(e,t,s){"use strict";s.r(t),s.d(t,{UserContext:function(){return m},default:function(){return x},useUserContext:function(){return h}});var n=s(9268);s(1168);var r=s(5846),a=s.n(r),l=()=>{let{logout:e}=h();return(0,n.jsxs)("div",{id:"sidebar",children:[(0,n.jsxs)("nav",{children:[(0,n.jsx)(a(),{href:"/",className:"logo",children:"LOGO"}),(0,n.jsx)(a(),{href:"/admin",children:"Панель администратора"}),(0,n.jsx)(a(),{href:"/admin/posts",children:"Объявления"}),(0,n.jsx)(a(),{href:"/admin/regions",children:"Районы"})]}),(0,n.jsx)("div",{className:"logout",onClick:e,children:"Выйти"})]})};s(5379);var i=s(6008),o=s(6006);s(980);var u=s(4214);let c={email:"",password:""};var d=()=>{let{login:e}=h(),[t,s]=(0,o.useState)(c),[r,a]=(0,o.useState)(""),l=async()=>{try{let{data:s,status:n}=await u.Z.post("/api/login",t,{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});console.log(s),200===n?e(s):404===n||401===n?a("Неправильно введен логин или пароль"):a("Что-то пошло не так, попробуйте еще раз")}catch(e){console.log(e),a("Что-то пошло не так, попробуйте еще раз")}},i=e=>{e.preventDefault();let n=e.currentTarget.value,r=e.currentTarget.name;s({...t,[r]:n}),a("")};return(0,n.jsx)("div",{id:"login",children:(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=null;t.email&&t.password||(s="Заполните объязательные поля"),s?a(s):l()},children:[(0,n.jsx)("div",{className:"title",children:"Войти в систему"}),(0,n.jsxs)("div",{className:"inputs",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"E-mail"}),(0,n.jsx)("input",{type:"text",name:"email",value:t.email,onChange:i})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Пароль"}),(0,n.jsx)("input",{type:"password",name:"password",value:t.password,onChange:i})]}),r&&(0,n.jsx)("div",{className:"error",children:r})]}),(0,n.jsx)("input",{type:"submit",value:"Войти",className:"submit"})]})})};let m=o.createContext(),h=()=>(0,o.useContext)(m);var x=e=>{let{children:t}=e;(0,i.useRouter)();let[s,r]=(0,o.useState)(null);return(0,o.useEffect)(()=>{if(!s&&localStorage.getItem("userdata")){let e=JSON.parse(localStorage.getItem("userdata"));r(e)}},[s]),(0,n.jsx)(m.Provider,{value:{userdata:s,login:e=>{r(e),localStorage.setItem("userdata",JSON.stringify(e))},logout:()=>{r(null),localStorage.removeItem("userdata")}},children:s&&s.user?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l,{}),(0,n.jsx)("main",{children:t})]}):(0,n.jsx)(d,{})})}},5379:function(){},980:function(){},1168:function(){},5846:function(e,t,s){e.exports=s(7477)},6008:function(e,t,s){e.exports=s(794)}},function(e){e.O(0,[815,214,477,253,769,744],function(){return e(e.s=4432)}),_N_E=e.O()}]);