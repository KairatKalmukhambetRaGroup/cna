(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[638],{9041:function(e,t,s){Promise.resolve().then(s.bind(s,9644))},9644:function(e,t,s){"use strict";s.r(t),s.d(t,{UserContext:function(){return h},default:function(){return f},metadata:function(){return x},useUserContext:function(){return m}});var n=s(7437);s(7349);var a=s(1396),r=s.n(a),l=s(2265),i=()=>{let{logout:e}=m(),[t,s]=(0,l.useState)(!0);return(0,n.jsxs)("div",{id:"sidebar",className:"".concat(t?"":"hide"),children:[(0,n.jsxs)("div",{className:"header",children:[(0,n.jsx)("i",{onClick:e=>{e.preventDefault(),s(!t)}}),(0,n.jsx)("a",{href:"https://cna.kz",className:"logo",children:"CNA"})]}),(0,n.jsxs)("div",{className:"content",children:[(0,n.jsxs)("nav",{children:[(0,n.jsx)(r(),{href:"/admin",children:"Панель администратора"}),(0,n.jsx)(r(),{href:"/admin/applications",children:"Заявки"}),(0,n.jsx)(r(),{href:"/admin/advertisements",children:"Рекламные баннеры"}),(0,n.jsx)(r(),{href:"/admin/posts",children:"Объявления"}),(0,n.jsx)(r(),{href:"/admin/cities",children:"Города"}),(0,n.jsx)(r(),{href:"/admin/phonebook",children:"Справочник"})]}),(0,n.jsx)("div",{className:"logout",onClick:e,children:"Выйти"})]})]})};s(2483);var c=s(4033);s(9699);var o=s(9222);let u={email:"",password:""};var d=()=>{let{login:e}=m(),[t,s]=(0,l.useState)(u),[a,r]=(0,l.useState)(""),i=async()=>{try{let{data:s,status:n}=await o.Z.post("/api/login",t,{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});console.log(s),200===n?e(s):404===n||401===n?r("Неправильно введен логин или пароль"):r("Что-то пошло не так, попробуйте еще раз")}catch(e){console.log(e),r("Что-то пошло не так, попробуйте еще раз")}},c=e=>{e.preventDefault();let n=e.currentTarget.value,a=e.currentTarget.name;s({...t,[a]:n}),r("")};return(0,n.jsx)("div",{id:"login",children:(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=null;t.email&&t.password||(s="Заполните объязательные поля"),s?r(s):i()},children:[(0,n.jsx)("div",{className:"title",children:"Войти в систему"}),(0,n.jsxs)("div",{className:"inputs",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"E-mail"}),(0,n.jsx)("input",{type:"text",name:"email",value:t.email,onChange:c})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Пароль"}),(0,n.jsx)("input",{type:"password",name:"password",value:t.password,onChange:c})]}),a&&(0,n.jsx)("div",{className:"error",children:a})]}),(0,n.jsx)("input",{type:"submit",value:"Войти",className:"submit"})]})})};let h=l.createContext(),m=()=>(0,l.useContext)(h),x={title:"CNA - Панель Администратора"};var f=e=>{let{children:t}=e;(0,c.useRouter)();let[s,a]=(0,l.useState)(null);return(0,l.useEffect)(()=>{if(!s&&localStorage.getItem("userdata")){let e=JSON.parse(localStorage.getItem("userdata"));a(e)}},[s]),(0,n.jsx)(h.Provider,{value:{userdata:s,login:e=>{a(e),localStorage.setItem("userdata",JSON.stringify(e))},logout:()=>{a(null),localStorage.removeItem("userdata")}},children:s&&s.user?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i,{}),(0,n.jsx)("main",{children:t})]}):(0,n.jsx)(d,{})})}},2483:function(){},9699:function(){},7349:function(){},4033:function(e,t,s){e.exports=s(8165)}},function(e){e.O(0,[750,396,971,596,744],function(){return e(e.s=9041)}),_N_E=e.O()}]);