(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[828],{6072:function(e,s,a){Promise.resolve().then(a.bind(a,4466))},4466:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return u}});var t=a(7437),n=a(9222),i=a(2265),l=a(73);a(1396),a(4421);var c=a(2496);let r={name:"",parent:""};var o=e=>{let{category:s,setCategory:a,setCategories:l}=e,[c,o]=(0,i.useState)(r);(0,i.useEffect)(()=>{s&&o(s)},[s]);let d=async e=>{if(e.preventDefault(),c._id){let{data:e}=await n.Z.patch("/api/phonebook/category",c,{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});l(e)}else{let{data:e}=await n.Z.post("/api/phonebook/category",c,{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});l(e)}h(e)},h=e=>{e.preventDefault(),o(r),a(null)};if(s)return(0,t.jsx)("div",{id:"categoryForm",children:(0,t.jsx)("div",{className:"container",children:(0,t.jsx)("div",{className:"content",children:(0,t.jsxs)("form",{className:c._id?"edit":"",onSubmit:d,children:[(0,t.jsx)("div",{className:"heading",children:"".concat(c._id?"Изменить":"Добавить"," ").concat(c.parent?"Категорию":"Раздел")}),(0,t.jsxs)("div",{className:"inputs",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Название"}),(0,t.jsx)("input",{type:"text",name:"name",value:c.name,onChange:e=>{let{name:s,value:a}=e.currentTarget;o({...c,[s]:a})}})]}),(0,t.jsxs)("div",{className:"btns",children:[(0,t.jsx)("div",{className:"btn clear",onClick:h,children:"Отмена"}),(0,t.jsx)("input",{className:"btn save",type:"submit",value:"".concat(c._id?"Изменить":"Добавить")})]})]})]})})})})};let d={name:"",phone:[""],whatsapp:"",telegram:"",email:"",address:"",description:"",category:""};var h=()=>{let[e,s]=(0,i.useState)(d),[a,r]=(0,i.useState)(null),[h,u]=(0,i.useState)(null),[p,m]=(0,i.useState)(null),[j,x]=(0,i.useState)(null),[v,g]=(0,i.useState)(null),N=async()=>{let{data:e}=await n.Z.get("/api/phonebook/category",{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});r(e)},f=async()=>{let{data:e}=await n.Z.get("/api/phonebook",{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});u(e),console.log(e)},C=e=>{s(e)};(0,i.useEffect)(()=>{f(),a||N()},[a]),(0,i.useEffect)(()=>{s(d)},[p]);let A=async s=>{if(s.preventDefault(),e._id){console.log(e._id);let{data:s}=await n.Z.patch("/api/phonebook",e,{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});u(s)}else{let s={...e,category:p},{data:a}=await n.Z.post("/api/phonebook",s,{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});u(a)}w()},w=()=>{s(d)},y=async e=>{if(e.preventDefault(),v){let{data:e}=await n.Z.delete("/api/phonebook/".concat(v),{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});g(null),u(e)}};return(0,t.jsxs)("div",{id:"phonebookcategories",children:[(0,t.jsx)(c.Ju,{deleteId:v,setDeleteId:g,deleteContact:y}),(0,t.jsx)(o,{category:j,setCategory:x,setCategories:r}),(0,t.jsxs)("div",{className:"content",children:[(0,t.jsx)("div",{className:"sidebar",children:(0,t.jsxs)("div",{className:"wrapper",children:[(0,t.jsx)("div",{className:"heading",children:"Справочник"}),(0,t.jsxs)("div",{className:"btn create-section",onClick:e=>{x({name:""})},children:["Добавить раздел ",(0,t.jsx)("i",{})]}),(0,t.jsx)("div",{className:"categories",children:a?a.length>0?a.map((e,s)=>(0,t.jsxs)("div",{className:"category",children:[(0,t.jsxs)("div",{className:"category-name",children:[e.name,(0,t.jsxs)("div",{className:"actions",children:[(0,t.jsx)("i",{className:"edit",onClick:s=>{x({_id:e._id,name:e.name})}}),(0,t.jsx)("i",{className:"add",onClick:s=>{x({parent:e._id})}})]})]}),e.sub.length>0&&(0,t.jsx)("div",{className:"subcategories",children:e.sub.map((s,a)=>(0,t.jsxs)("div",{className:"subcategory ".concat(p===s._id?"active":""),onClick:e=>m(s._id),children:[s.name,p===s._id&&(0,t.jsx)("i",{className:"edit",onClick:a=>{x({_id:s._id,name:s.name,parent:e._id})}})]},a))})]},s)):"Нет категории":(0,t.jsx)(l.Z,{})})]})}),(0,t.jsxs)("div",{className:"contacts",children:[p&&(0,t.jsx)(c.fJ,{activeCategory:p,formData:e,setFormData:s,clear:w,handleSubmit:A}),(0,t.jsxs)("div",{className:"phonenumbers",children:[h?h.length>0?h.filter(e=>e.category._id===p).map((e,s)=>(0,t.jsxs)("div",{className:"phonenumber",children:[(0,t.jsxs)("div",{className:"body",children:[(0,t.jsx)("div",{className:"name",children:e.name}),e.description&&(0,t.jsx)("div",{className:"description",children:e.description}),(0,t.jsxs)("nav",{className:"info",children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("span",{className:"title",children:"Телефон:"}),e.phone?e.phone.join(", "):"Нет"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("span",{className:"title",children:"Э-почта:"}),e.email||"Нет"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("span",{className:"title",children:"Адрес:"}),e.address||"Нет"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("span",{className:"title",children:"Whatsapp:"}),e.whatsapp?"wa.me/".concat(e.whatsapp):"Нет"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("span",{className:"title",children:"Telegram:"}),e.telegram?"t.me/".concat(e.telegram):"Нет"]})]})]}),(0,t.jsxs)("div",{className:"actions",children:[(0,t.jsx)("div",{className:"action",onClick:s=>{s.preventDefault(),C(e)},children:"Изменить"}),(0,t.jsx)("div",{className:"action delete",onClick:s=>{s.preventDefault(),g(e._id)},children:"Удалить"})]})]},s)):(0,t.jsx)("div",{className:"center",children:"Нет категории"}):(0,t.jsx)("div",{className:"center",children:(0,t.jsx)(l.Z,{})}),!p&&(0,t.jsx)("div",{className:"center",children:"Выберите категорию"})]})]})]})]})},u=()=>(0,t.jsx)(h,{})}},function(e){e.O(0,[750,685,427,971,596,744],function(){return e(e.s=6072)}),_N_E=e.O()}]);