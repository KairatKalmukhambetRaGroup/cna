(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[289],{7885:function(e,t,o){Promise.resolve().then(o.bind(o,3563))},3563:function(e,t,o){"use strict";o.r(t);var s=o(7437),n=o(5369),a=o(1415),r=o(7358),i=o(1206);o(7652);var l=o(8758),c=o(9222),u=o(4033),f=o(2265);let h={housing:"apartments",rooms:[],purpose:[],placement:[],city:"",region:"",price:{from:"",to:""},material:[],year:{from:"",to:""},floor:{from:"",to:""},floors:{from:"",to:""},plot:{from:"",to:""},heating:[],sewerage:[],bathroom:[],total_area:{from:"",to:""},kitchen_area:{from:"",to:""},living_area:{from:"",to:""},sort:"new"};t.default=()=>{let e=(0,u.useRouter)(),t=(0,u.useSearchParams)(),[o,m]=(0,f.useState)(h),[g,d]=(0,f.useState)(),[p,w]=(0,f.useState)(),[S,v]=(0,f.useState)(null),[E,y]=(0,f.useState)(1),[A,C]=(0,f.useState)(1),[_,x]=(0,f.useState)(!0),[j,O]=(0,f.useState)(0),[Z,b]=(0,f.useState)(""),k=(t,s)=>{if(m({...o,[t]:s}),"city"===t&&o.city!==s){s||d([]);for(let e=0;e<S.length;e++){let t=S[e];t.name===s&&d(t.regions.map(e=>e.short))}}if("housing"===t){m({...h,[t]:s});let o=(0,l.rW)({[t]:s});e.push("".concat(o)),b(o)}else if("sort"===t){let n=(0,l.rW)({...o,[t]:s});e.push("".concat(n)),b(n)}},[N,W]=(0,f.useState)([]),H=async()=>{x(!0),console.log(A,Z);let{data:e}=await c.Z.get("/api/posts/sell".concat(Z.includes("?")?Z:"?"+Z,"&page=").concat(A),{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}}),t=e.posts;console.log(t),y(e.totalPages),O(e.count),W(e=>[...e,...t]),x(!1)},D=async()=>{let{data:e}=await c.Z.get("/api/cities",{validateStatus:function(e){return!0},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}});v(e),w(e.map(e=>e.name))};(0,f.useEffect)(()=>{H()},[A]),(0,f.useEffect)(()=>{W([]),x(!0),C(1)},[Z]);let P=()=>{window.innerHeight+document.documentElement.scrollTop!==document.documentElement.offsetHeight||_||C(e=>e+1)};return(0,f.useEffect)(()=>(A<E&&window.addEventListener("scroll",P),()=>{window.removeEventListener("scroll",P)}),[_]),(0,f.useEffect)(()=>{if(p){if(o.city)for(let e=0;e<S.length;e++){let t=S[e];t.name===o.city&&d(t.regions.map(e=>e.short))}}else D()},[p]),(0,f.useEffect)(()=>{let e=t.toString(),s=(0,l.pQ)(e);s.housing||(s.housing="apartment"),m({...o,...s}),b(e)},[t]),(0,s.jsxs)("div",{id:"allposts",children:[(0,s.jsx)(a.Z,{}),(0,s.jsx)(n.Z,{prefix:"Покупка",housing:o.housing,cities:p,regions:g,formData:o,handleChange:k,handleSubmit:t=>{t.preventDefault();let s=(0,l.rW)(o);e.push("".concat(s))}}),(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)("div",{className:"content",children:[(0,s.jsx)(r.Z,{posts:N,loading:_,title:o.housing,formData:o,handleChange:k,total:j}),(0,s.jsx)(i.Z,{})]})})]})}}},function(e){e.O(0,[750,685,330,530,429,971,596,744],function(){return e(e.s=7885)}),_N_E=e.O()}]);